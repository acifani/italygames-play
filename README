                    / italygames-play /


    ~ Requisiti

        docker, docker-compose

    ~ Configurazione

        1. File mysql.env configurato con
            MYSQL_ROOT_PASSWORD=root_pass
            MYSQL_DATABASE=db_name
            MYSQL_USER=db_user
            MYSQL_PASSWORD=user_padd

        2. File instance/config.py configurato con
            - SECRET_KEY = 'chiavemoltosegreta'
            - SQLALCHEMY_DATABASE_URI = 'db_uri'
            - OAUTH_CREDENTIALS = {
                'provider_name': {
                    'id': 'provider_id',
                    'secret': 'provider_secret'
                }
            }

    ~ Prima build

        1. Buildare la docker image: docker-compose build
        2. Avviare i container: docker-compose up
        3. Creare tabelle nel db:
            - sudo docker-compose run --rm web bash
                > python manage.py create_db
                > python manage.py db upgrade

    ~ Esecuzione

        docker-compose up

    ~ Manutenzione DB

        Per generare lo script di migration, una volta eseguita la modifica:
            - python manage.py migrate -m
            - check dello script generato in migrations/versions
            - python manage.py db upgrade
            - commit della modifica

        Per migrare i db di prod:
            - git pull origin master
            - docker-compose stop
            - docker-compose build
            - docker-compose up -d
            - sudo docker-compose run --rm web bash
                > python manage.py db upgrade
